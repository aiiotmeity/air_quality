<!DOCTYPE html>
<html>
<head>
  {% load static %}
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link href="{% static 'css/index1.css' %}" rel="stylesheet" />

</head>
<body>
  <!-- Navbar -->
 <nav class="navbar">
  <div style="display: flex; justify-content: space-between; align-items: center; max-width: 1200px; margin: 0 auto;">
    <a href="#" class="navbar-brand">
      <img src="{% static 'img/aqi.jpg' %}" alt="AQM Logo" width="30" height="30">
      AQM
    </a>
    <div class="menu-toggle" onclick="toggleMenu()">
      <i class="fas fa-bars"></i>
    </div>
    <ul class="nav-links">
      <li><a href="{% url 'map_view' %}" class="nav-link">Home</a></li>
      <li><a href="#cities" class="nav-link">Cities</a></li>
      <li><a href="#services" class="nav-link">Services</a></li>
      <li><a href="#contact" class="nav-link">Contact</a></li>
      <li><a href=" " class="nav-link">Dashboard</a></li>
      <li><a href="{% url 'index_test' %}" class="nav-link">Forecasting</a></li>
     <li>
    <a href="{% url 'login' %}" class="nav-link">
        <i class="fas fa-sign-in-alt"></i> Login
    </a>
</li>
    </ul>
  </div>
</nav>
  <!-- Hero Section -->
  <section class="hero-section" id="home">
    <div id="particles" class="particles"></div>
    <div class="hero-content">
      <h1 style="font-size: 2.5rem; margin-bottom: 20px;">Air Quality Monitoring</h1>
      <p style="font-size: 1.2rem; margin-bottom: 30px;">Real-time air quality monitoring and analysis for cities across Kerala</p>

      <div class="aqi-container">
        <div style="font-size: 1.1rem;">Last Updated: <span id="received-at">N/A</span></div>


        <div class="aqi-value" id="aqi">{{ highest_sub_index }}</div>

        <div class="aqi-status">AQI - GOOD</div>
        <i class="fas fa-smile" style="font-size: 2rem; color: #2ecc71;"></i>
      </div>

      <a href="{% url 'map_view' %}" class="check-map-btn">
        <i class="fas fa-map-marked-alt"></i>
        CHECK AQI MAP
      </a>
    </div>
  </section>

<section class="cities-section" id="cities">
  <h2 style="text-align: center; margin-bottom: 30px;">City-wise Pollution in Kerala</h2>
  <div class="cities-section">
  <div class="city-grid">
    <div class="city-card">
      <div class="city-icon"><i class="fas fa-building"></i></div>
      <a href="{% url 'map_view' %}" class="city-link" style="text-decoration: none;">
      <div>Adi Shankara Institute of Engineering and Technology</div>
      </a>
    </div>
        <div class="city-card">
      <div class="city-icon">
        <i class="fas fa-building"></i>
      </div>
      <a href="{% url 'map_view' %}" class="city-link" style="text-decoration: none;">
        <div>Matoor, Ernakulam</div>

      </a>
    </div>
    <div class="city-card">
      <div class="city-icon"><i class="fas fa-building"></i></div>
      <a href="{% url 'map_view' %}" class="city-link" style="text-decoration: none;">
      <div>Marotichodu Community Hall, Ernakulam</div>
      </a>
    </div>
    <div class="city-card">
      <div class="city-icon"><i class="fas fa-building"></i></div>
      <a href="{% url 'map_view' %}" class="city-link" style="text-decoration: none;">
      <div>Kaipatoor, Ernakulam</div>
      </a>
    </div>

    <div class="city-card">
      <div class="city-icon"><i class="fas fa-building"></i></div>
      <a href="{% url 'map_view' %}" class="city-link" style="text-decoration: none;">
      <div>Kalady Panchayat Office, Ernakulam</div>
      </a>
    </div>


  </div>
</div>

</section>



  <!-- Services Section -->
  <section class="services-section" id="services">
    <h2 style="text-align: center; margin-bottom: 40px;">Our Services</h2>
    <div class="services-grid">
      <div class="service-card">
        <i class="fas fa-chart-line service-icon"></i>
        <h3>personalized AQI forecast</h3>
        <p>Advanced air quality monitoring systems providing accurate and up-to-date data.</p>
        <a href="{% url 'risk_assessment'  %}" class="check-map-btn" style="margin-top: 20px;">AQI Forecast</a>
      </div>
     <div class="service-card">
        <i class="fas fa-heartbeat service-icon"></i>
        <h3>Personalized Health Risk Assessment</h3>
        <p>Comprehensive analysis of air quality trends and pollution patterns.</p>
        <a href="{% url 'risk_assessment'  %}" class="check-map-btn" style="margin-top: 20px;">Risk Assessment</a>


    </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer" id="contact">
    <div class="footer-grid">
      <div>
        <h3 class="footer-heading">About Us</h3>
        <p>Leading provider of air quality monitoring solutions in Kerala, committed to environmental sustainability.</p>
        <div class="social-icons">
          <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
          <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a>
          <a href="#" class="social-icon"><i class="fab fa-linkedin-in"></i></a>
          <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
        </div>
      </div>

      <div>
        <h3 class="footer-heading">Quick Links</h3>
        <a href="#" class="footer-link">Home</a>
        <a href="#" class="footer-link">About Us</a>
        <a href="#" class="footer-link">Services</a>
        <a href="#" class="footer-link">Contact</a>
        <a href="{% url 'logout' %}" class="btn btn-primary px-4">Logout</a>
      </div>

      <div>
        <h3 class="footer-heading">Services</h3>
        <a href="#" class="footer-link">Air Quality Monitoring</a>
        <a href="#" class="footer-link">Data Analysis</a>
        <a href="#" class="footer-link">Consultation</a>
        <a href="#" class="footer-link">Research</a>
      </div>

      <div>
        <h3 class="footer-heading">Contact Info</h3>
        <p>Vidya Bharathi Nagar, Mattoor, Kalady 683574<br>
        Ernakulam, Kerala<br>
        India</p>
        <p>Email: aiiot@adishankara.ac.in<br>
        Phone: 0484 246 3825</p>
      </div>
    </div>
  </footer>
 <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    function fetchLatestData() {
  $.ajax({
    url: "{% url 'home' %}", // Ensure 'home' is defined in urls.py
    type: "GET",
    dataType: "json",
    success: function (data) {
      console.log("AJAX success:", data); // Debugging
      if (data.latest_item) {
        updateDashboard(data.latest_item, data.highest_sub_index);
      } else {
        console.error("No data in response.");
      }
    },
    error: function (xhr, status, error) {
      console.error("AJAX error:", error);
    }
  });
}

function updateDashboard(latestItem, highestSubIndex) {
  $('#received-at').text(latestItem.date || 'N/A');
  $('#time').text(latestItem.time || 'N/A');

  $('#aqi').text(highestSubIndex || 'N/A');

  // Update the status and styling based on AQI
  const aqiValue = parseInt(highestSubIndex || 0, 10);
  const aqiStatusElement = $('.aqi-status');
  const aqiIconElement = $('.aqi-container i');

  if (aqiValue <= 50) {
    aqiStatusElement.text('AQI - GOOD');
    aqiIconElement.attr('class', 'fas fa-smile').css('color', '#2ecc71');
  } else if (aqiValue <= 100) {
    aqiStatusElement.text('AQI - MODERATE');
    aqiIconElement.attr('class', 'fas fa-meh').css('color', '#f1c40f');
  } else if (aqiValue <= 150) {
    aqiStatusElement.text('AQI - Unhealthy');
    aqiIconElement.attr('class', 'fas fa-meh').css('color', '#f1c40f');
  }else {
    aqiStatusElement.text('AQI - POOR');
    aqiIconElement.attr('class', 'fas fa-frown').css('color', '#e74c3c');
  }
}

    // Fetch data every 5 seconds
    setInterval(fetchLatestData, 5000);

    // Fetch data on page load
    $(document).ready(function() {
      fetchLatestData();
    });

    function createParticles() {
        const particlesContainer = document.getElementById('particles');
        for (let i = 0; i < 70; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.top = Math.random() * 100 + '%';
            particle.style.width = Math.random() * 10 + 5 + 'px';
            particle.style.height = particle.style.width;
            particle.style.animationDelay = Math.random() * 5 + 's';
            particlesContainer.appendChild(particle);
        }
    }

    // Smooth scrolling
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            document.querySelector(this.getAttribute('href')).scrollIntoView({
                behavior: 'smooth'
            });
        });
    });

    // Initialize particles
    window.addEventListener('load', createParticles);

    function toggleMenu() {
        const navLinks = document.querySelector('.nav-links');
        navLinks.classList.toggle('active');
    }

    // Fetch the latest data and initialize particles on page load
    window.addEventListener('load', fetchLatestData);
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>
